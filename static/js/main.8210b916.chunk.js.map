{"version":3,"sources":["App.js","index.js"],"names":["BASE_URL","accessToken","navigator","userAgent","LOGOUT","LIST_URL","standard","cb","a","fetch","response","json","map","callback","data","console","error","formatVideoArray","videos","length","reduce","acc","currentVid","subject","updateRecordedVideoList","ELIGIBILITY_STATES","App","useState","updateAccessToken","apiData","updateApiData","visible","updateVisible","vidList","updateVidList","liveData","updateLiveData","isEligibility","updateEligibility","showLogout","updateLogOutModal","useEffect","accessTokenURL","URLSearchParams","window","location","search","get","prompt","loadLiveData","description","eligibility","message","name","videoUrl","loadRecordedVideos","hideMenu","hideLogoutMenu","updateCurrentVideo","video","val","Sidebar","Pushable","as","Menu","animation","icon","inverted","onHide","vertical","Item","Header","className","onClick","Object","keys","sort","Icon","id","Pusher","dimmed","style","height","Container","fluid","header","position","width","src","textAlign","Message","Modal","onClose","open","Content","image","Description","Actions","Button","color","negative","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.8210b916.chunk.js","sourcesContent":["import { useEffect, useState } from 'react';\nimport {\n  Container,\n  Icon,\n  Menu,\n  Sidebar,\n  Header,\n  Message,\n  Modal,\n  Button\n} from 'semantic-ui-react'\nimport './App.css';\nimport 'semantic-ui-css/semantic.min.css'\n\nconst BASE_URL = (accessToken) => `https://chmkms-demo.herokuapp.com/api/live/?accessToken=${accessToken}&userAgent=${navigator.userAgent}`\n\nconst LOGOUT = (accessToken) => `https://chmkms-demo.herokuapp.com/api/live/logout?accessToken=${accessToken}`\n\nconst LIST_URL = (accessToken, standard) => `http://chmkms-demo.herokuapp.com/api/class/${standard}/recorded-videos?accessToken=${accessToken}`\n\nasync function loadLiveData(accessToken, cb) {\n  try {\n    const response = await fetch(BASE_URL(accessToken))\n    const json = await response.json()\n    cb.map(callback => callback(json.data))\n  } catch (error) {\n    console.error(error)\n  }\n}\n\nfunction formatVideoArray(videos) {\n  if (videos && videos.length) {\n    return videos.reduce((acc, currentVid) => ({\n      ...acc,\n      [currentVid.subject]: acc[currentVid.subject] ? [...acc[currentVid.subject], currentVid] : [currentVid]\n    }), [])\n  }\n  else return []\n}\n\nasync function loadRecordedVideos(accessToken, standard, updateRecordedVideoList) {\n  try {\n    const response = await fetch(LIST_URL(accessToken, standard))\n    const json = await response.json()\n    updateRecordedVideoList(formatVideoArray(json.data))\n  } catch (error) {\n    console.error(error)\n  }\n}\n\nconst ELIGIBILITY_STATES = {\n  PAISA_DIYA: 1,\n  PAISA_NAHI_DIYA: -1\n}\n\nfunction App() {\n  const [accessToken, updateAccessToken] = useState()\n  const [apiData, updateApiData] = useState({})\n  const [visible, updateVisible] = useState(false)\n  const [vidList, updateVidList] = useState(null)\n  const [liveData, updateLiveData] = useState(null)\n  const [isEligibility, updateEligibility] = useState(true)\n  const [showLogout, updateLogOutModal] = useState(false)\n\n  useEffect(() => {\n    const params = new URLSearchParams(window.location.search)\n    const accessTokenURL = params.get('accessToken')\n    if (accessTokenURL) updateAccessToken(accessTokenURL)\n    else updateAccessToken(window.prompt('Enter Access Token'))\n  }, [])\n\n  useEffect(() => accessToken && loadLiveData(accessToken, [updateApiData, updateLiveData]), [accessToken])\n  const { description, standard, subject, eligibility, message, name, userAgent, videoUrl } = apiData\n\n  useEffect(() => {\n    if (ELIGIBILITY_STATES.PAISA_DIYA === eligibility) {\n      if (userAgent === navigator.userAgent) return\n      updateEligibility(false)\n    } else if (ELIGIBILITY_STATES.PAISA_NAHI_DIYA === eligibility) updateEligibility(false)\n  }, [userAgent, isEligibility, eligibility])\n\n  useEffect(() => {\n    if (standard && accessToken && isEligibility) loadRecordedVideos(accessToken, standard, updateVidList)\n  }, [standard, accessToken, isEligibility])\n\n  const showMenu = () => updateVisible(true)\n  const hideMenu = () => updateVisible(false)\n\n  const showLogoutMenu = () => updateLogOutModal(true)\n  const hideLogoutMenu = () => updateLogOutModal(false)\n\n  function updateCurrentVideo(video) {\n    updateApiData(val => ({\n      ...val,\n      ...video\n    }))\n    hideMenu()\n  }\n\n  async function handleLogout() {\n    const response = await fetch(LOGOUT(accessToken))\n    const json = await response.json()\n    if(json){ \n      updateAccessToken()\n      hideLogoutMenu()\n      window.location.search = ''\n    }\n    return\n  }\n\n  return <>\n    <Sidebar.Pushable>\n      <Sidebar\n        as={Menu}\n        animation='overlay'\n        icon='labeled'\n        inverted\n        onHide={hideMenu}\n        vertical\n        visible={visible}\n      >\n        {liveData && liveData.videoUrl ? <>\n          <Menu.Item>\n            <Header inverted as='b' className=\"red\">LIVE</Header>\n          </Menu.Item>\n          <Menu.Item name=\"video\" onClick={() => updateCurrentVideo(liveData)}>\n            <Menu.Header as='a'>{liveData.name}</Menu.Header>\n            <p>{liveData.description}</p>\n          </Menu.Item>\n        </> : null}\n        {vidList && Object.keys(vidList).sort().map(subject => {\n          return (\n            <Menu.Item key={subject}>\n              <Menu.Item>\n                <div>\n                  <Icon name=\"book\"/>\n                  <Header inverted as='b' className=\"blue\">{subject}</Header> &nbsp;\n                  <Icon name=\"book\"/>\n                </div>\n              </Menu.Item>\n              {vidList[subject].map((video) => (\n                <Menu.Item key={video.id} name=\"video\" onClick={() => updateCurrentVideo(video)}>\n                  <Menu.Header as='a'>{video.name}</Menu.Header>\n                  <p>{video.description}</p>\n                </Menu.Item>\n              ))}\n            </Menu.Item>\n          )\n        })}\n      </Sidebar>\n      <Sidebar.Pusher dimmed={visible} style={{ height: \"100%\" }}>\n        <Container fluid style={{ height: \"100%\" }} >\n          <Container fluid>\n            <Menu inverted>\n              <Menu.Item\n                name='list'\n                onClick={showMenu}\n              >\n                <Icon name='list' />\n              </Menu.Item>\n              <Menu.Item as='b' header>\n                {standard}\n              </Menu.Item>\n              <Menu.Item as='b' header>\n                {subject}\n              </Menu.Item>\n              <Menu.Item as='b' header>\n                {name}\n              </Menu.Item>\n              <Menu.Item as='b' header>\n                {description}\n              </Menu.Item>\n              <Menu.Item icon=\"log out\" position=\"right\" onClick={showLogoutMenu} header />\n            </Menu>\n          </Container>\n          <Container fluid style={{ height: \"100%\" }}>\n            {isEligibility && videoUrl ? <iframe width=\"100%\" height=\"100%\" src={videoUrl} /> : message ? (\n              <Container textAlign=\"center\" inverted>\n                <Message>{message}</Message>\n              </Container>\n            ) : null}\n          </Container>\n        </Container>\n        <Modal\n          onClose={hideLogoutMenu}\n          open={showLogout}\n        >\n          <Modal.Header>Help</Modal.Header>\n          <Modal.Content image>\n            <Modal.Description>\n              Logout from this device, to view classes from another device\n            </Modal.Description>\n          </Modal.Content>\n          <Modal.Actions>\n            <Button color='red' onClick={handleLogout} negative>\n             Yes, log me out.\n            </Button>\n          </Modal.Actions>\n        </Modal>\n      </Sidebar.Pusher>\n    </Sidebar.Pushable>\n  </>\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport './index.css';\n// import reportWebVitals from './reportWebVitals';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n// reportWebVitals();\n"],"sourceRoot":""}