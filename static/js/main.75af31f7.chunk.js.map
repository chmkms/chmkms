{"version":3,"sources":["App.js","index.js"],"names":["BASE_URL","accessToken","navigator","userAgent","LOGOUT","LIST_URL","standard","cb","a","fetch","response","json","map","callback","data","console","error","formatVideoArray","videos","length","reduce","acc","currentVid","subject","updateRecordedVideoList","ELIGIBILITY_STATES","App","useState","updateAccessToken","apiData","updateApiData","visible","updateVisible","vidList","updateVidList","liveData","updateLiveData","isEligibility","updateEligibility","showLogout","updateLogOutModal","useEffect","accessTokenURL","URLSearchParams","window","location","search","get","localStorage","getItem","prompt","setItem","loadLiveData","description","eligibility","message","name","videoUrl","document","title","loadRecordedVideos","hideMenu","hideLogoutMenu","updateCurrentVideo","video","val","removeItem","Sidebar","Pushable","as","Menu","animation","icon","inverted","onHide","vertical","Item","Header","className","onClick","Object","keys","sort","Icon","id","Pusher","dimmed","style","height","Container","fluid","header","position","width","src","textAlign","Message","Modal","onClose","open","Content","image","Description","Actions","Button","color","negative","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.75af31f7.chunk.js","sourcesContent":["import { useEffect, useState } from 'react';\nimport {\n  Container,\n  Icon,\n  Menu,\n  Sidebar,\n  Header,\n  Message,\n  Modal,\n  Button\n} from 'semantic-ui-react'\nimport './App.css';\nimport 'semantic-ui-css/semantic.min.css'\n\nconst BASE_URL = (accessToken) => `https://chmkms-demo.herokuapp.com/api/live/?accessToken=${accessToken}&userAgent=${navigator.userAgent}`\n\nconst LOGOUT = (accessToken) => `https://chmkms-demo.herokuapp.com/api/live/logout?accessToken=${accessToken}`\n\nconst LIST_URL = (accessToken, standard) => `http://chmkms-demo.herokuapp.com/api/class/${standard}/recorded-videos?accessToken=${accessToken}`\n\nasync function loadLiveData(accessToken, cb) {\n  try {\n    const response = await fetch(BASE_URL(accessToken))\n    const json = await response.json()\n    cb.map(callback => callback(json.data))\n  } catch (error) {\n    console.error(error)\n  }\n}\n\nfunction formatVideoArray(videos) {\n  if (videos && videos.length) {\n    return videos.reduce((acc, currentVid) => ({\n      ...acc,\n      [currentVid.subject]: acc[currentVid.subject] ? [...acc[currentVid.subject], currentVid] : [currentVid]\n    }), [])\n  }\n  else return []\n}\n\nasync function loadRecordedVideos(accessToken, standard, updateRecordedVideoList) {\n  try {\n    const response = await fetch(LIST_URL(accessToken, standard))\n    const json = await response.json()\n    updateRecordedVideoList(formatVideoArray(json.data))\n  } catch (error) {\n    console.error(error)\n  }\n}\n\nconst ELIGIBILITY_STATES = {\n  PAISA_DIYA: 1,\n  PAISA_NAHI_DIYA: -1\n}\n\nfunction App() {\n  const [accessToken, updateAccessToken] = useState()\n  const [apiData, updateApiData] = useState({})\n  const [visible, updateVisible] = useState(false)\n  const [vidList, updateVidList] = useState(null)\n  const [liveData, updateLiveData] = useState(null)\n  const [isEligibility, updateEligibility] = useState(true)\n  const [showLogout, updateLogOutModal] = useState(false)\n\n  useEffect(() => {\n    const params = new URLSearchParams(window.location.search)\n    const accessTokenURL = params.get('accessToken')\n    if (accessTokenURL) updateAccessToken(accessTokenURL)\n    else if(localStorage.getItem('accessToken')) updateAccessToken(localStorage.getItem('accessToken'))\n    else updateAccessToken(window.prompt('Enter Access Token'))\n  }, [])\n\n  useEffect(() => {\n    if(accessToken){\n      localStorage.setItem('accessToken', accessToken)\n      loadLiveData(accessToken, [updateApiData, updateLiveData])\n    }\n    }, [accessToken])\n  const { description, standard, subject, eligibility, message, name, userAgent, videoUrl } = apiData\n\n  useEffect(() => {\n    if(standard || subject) document.title = `CHMKMS | ${standard} | ${subject}`\n  }, [standard, subject])\n\n  useEffect(() => {\n    if (ELIGIBILITY_STATES.PAISA_DIYA === eligibility) {\n      if (userAgent === navigator.userAgent) return\n      updateEligibility(false)\n    } else if (ELIGIBILITY_STATES.PAISA_NAHI_DIYA === eligibility) updateEligibility(false)\n  }, [userAgent, isEligibility, eligibility])\n\n  useEffect(() => {\n    if (standard && accessToken && isEligibility) loadRecordedVideos(accessToken, standard, updateVidList)\n  }, [standard, accessToken, isEligibility])\n\n  const showMenu = () => updateVisible(true)\n  const hideMenu = () => updateVisible(false)\n\n  const showLogoutMenu = () => updateLogOutModal(true)\n  const hideLogoutMenu = () => updateLogOutModal(false)\n\n  function updateCurrentVideo(video) {\n    updateApiData(val => ({\n      ...val,\n      ...video\n    }))\n    hideMenu()\n  }\n\n  async function handleLogout() {\n    const response = await fetch(LOGOUT(accessToken))\n    const json = await response.json()\n    if(json){ \n      updateAccessToken()\n      hideLogoutMenu()\n      localStorage.removeItem('accessToken')\n      window.location.search = ''\n    }\n    return\n  }\n\n  return <>\n    <Sidebar.Pushable>\n      <Sidebar\n        as={Menu}\n        animation='overlay'\n        icon='labeled'\n        inverted\n        onHide={hideMenu}\n        vertical\n        visible={visible}\n      >\n        {liveData && liveData.videoUrl ? <>\n          <Menu.Item>\n            <Header inverted as='b' className=\"red\">LIVE</Header>\n          </Menu.Item>\n          <Menu.Item name=\"video\" onClick={() => updateCurrentVideo(liveData)}>\n            <Menu.Header as='a'>{liveData.name}</Menu.Header>\n            <p>{liveData.description}</p>\n          </Menu.Item>\n        </> : null}\n        {vidList && Object.keys(vidList).sort().map(subject => {\n          return (\n            <Menu.Item key={subject}>\n              <Menu.Item>\n                <div>\n                  <Icon name=\"book\"/>\n                  <Header inverted as='b' className=\"blue\">{subject}</Header> &nbsp;\n                  <Icon name=\"book\"/>\n                </div>\n              </Menu.Item>\n              {vidList[subject].map((video) => (\n                <Menu.Item key={video.id} name=\"video\" onClick={() => updateCurrentVideo(video)}>\n                  <Menu.Header as='a'>{video.name}</Menu.Header>\n                  <p>{video.description}</p>\n                </Menu.Item>\n              ))}\n            </Menu.Item>\n          )\n        })}\n      </Sidebar>\n      <Sidebar.Pusher dimmed={visible} style={{ height: \"100%\" }}>\n        <Container fluid style={{ height: \"100%\" }} >\n          <Container fluid>\n            <Menu inverted>\n              <Menu.Item\n                name='list'\n                onClick={showMenu}\n              >\n                <Icon name='list' />\n              </Menu.Item>\n              <Menu.Item as='b' header>\n                {standard}\n              </Menu.Item>\n              <Menu.Item as='b' header>\n                {subject}\n              </Menu.Item>\n              <Menu.Item as='b' header>\n                {name}\n              </Menu.Item>\n              <Menu.Item as='b' header>\n                {description}\n              </Menu.Item>\n              <Menu.Item icon=\"log out\" position=\"right\" onClick={showLogoutMenu} header />\n            </Menu>\n          </Container>\n          <Container fluid style={{ height: \"100%\" }}>\n            {isEligibility && videoUrl ? <iframe title=\"Live class\" width=\"100%\" height=\"100%\" src={videoUrl} /> : message ? (\n              <Container textAlign=\"center\" inverted>\n                <Message>{message}</Message>\n              </Container>\n            ) : null}\n          </Container>\n        </Container>\n        <Modal\n          onClose={hideLogoutMenu}\n          open={showLogout}\n        >\n          <Modal.Header>Help</Modal.Header>\n          <Modal.Content image>\n            <Modal.Description>\n              Logout from this device, to view classes from another device\n            </Modal.Description>\n          </Modal.Content>\n          <Modal.Actions>\n            <Button color='red' onClick={handleLogout} negative>\n             Yes, log me out.\n            </Button>\n          </Modal.Actions>\n        </Modal>\n      </Sidebar.Pusher>\n    </Sidebar.Pushable>\n  </>\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport './index.css';\n// import reportWebVitals from './reportWebVitals';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n// reportWebVitals();\n"],"sourceRoot":""}